<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>EPUBConverter 0.0.2 - 其實已經重寫了 Orz | Corleonis</title>
<link href="../assets/css/bitter.css" rel="stylesheet" type="text/css">
<link href="../assets/css/main.css" rel="stylesheet" type="text/css">
<link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../assets/css/code.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="http://swind.code-life.info/posts/epubconverter-0_0_2.html">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'left', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Swind">
<meta property="og:site_name" content="Corleonis">
<meta property="og:title" content="EPUBConverter 0.0.2 - 其實已經重寫了 Orz">
<meta property="og:url" content="http://swind.code-life.info/posts/epubconverter-0_0_2.html">
<meta property="og:description" content="一開始的 Scala 版本本來是自己寫來自己用的小工具，可是沒想到竟然有人有用還有回報問題。
大受感動之餘（誤），而出現了這個全新感受的 EPUBConverter 0.0.2，絕對不是因為手癢想要試試看 Go。
P.S 2012.12.09 更新 - 修正了鳥 Bug 所以到 0.0.3 了。
EPUBConverter 0.0.3 下載
EPUBConverter Source Code
這個">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2012-12-08T18:00:00+08:00">
<meta property="article:tag" content="Go">
</head>
<body>
    <section class="social"><ul>
<li><a href="../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://github.com/Swind" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
            
    <div class="post">
    
    <h1 class="p-name entry-title" itemprop="headline name">EPUBConverter 0.0.2 - 其實已經重寫了 Orz</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2012-12-08T18:00:00+08:00">2012-12-08 18:00</time>
            

            
          |  
        <a href="epubconverter-0_0_2.rst" id="sourcelink">Source</a>

            </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="../categories/go.html" rel="tag">Go</a></li>
        </ul>
</div>

        </div>
        <div class="body">
            <div>
<p>一開始的 Scala 版本本來是自己寫來自己用的小工具，可是沒想到竟然有人有用還有回報問題。
大受感動之餘（誤），而出現了這個全新感受的 EPUBConverter 0.0.2，絕對不是因為手癢想要試試看 Go。</p>
<p>P.S 2012.12.09 更新 - 修正了鳥 Bug 所以到 0.0.3 了。</p>
<p><a class="reference external" href="https://dl.dropbox.com/u/15537823/EPUBConverter_0.0.3.7z">EPUBConverter 0.0.3 下載</a></p>
<p><a class="reference external" href="https://github.com/Swind/EPUBConverter-Go">EPUBConverter Source Code</a></p>
<p>這個版本比之前好得地方在於，這次使用了 <a class="reference external" href="http://tongwen.openfoundry.org/">新同文堂</a> 的簡繁轉換對照表。
除了單字轉換之外，還多了一個詞彙轉換。</p>
<p>所以轉換品質應該會比之前 Scala 的版本好很多，感謝新同文堂分享對照表。
他的 Bookmarklet 版本也非常好用，基本上我 Go 的轉換邏輯就是從 Bookmarklet 版本移植過來的。</p>
<p>但是由於我直接將對照表轉換成 Golang 裡面的 map 了，所以這次就沒有辦法讓使用者自己改對照表了。</p>
<p>不過有興趣的人，在原始碼的 <a class="reference external" href="https://github.com/Swind/EPUBConverter-Go/tree/master/tongwen_table">tongwen_table</a> 資料夾底下，我有放了一個簡單的轉換工具。
可以利用那個重新產生 Go 的 map，但是最後還是得重新編譯整個 EPUBConverter 就是了。</p>
<!-- TEASER_END -->
<p>延續之前的我的偷懶寫法，這次也是寫死只會轉換 source 資料夾底下的 epub 檔案，輸出到 target 資料夾。
可是這次全部都在記憶體裡面處理，所以不會先解壓縮到磁碟上然後壓縮再刪除了。</p>
<pre class="literal-block">
/EPUBConverter
           source
           target
           epubconverter.exe
</pre>
<p>以上，如果有什麼問題的話也歡迎回覆，如果我有錢有閒而且沒事做的話 Orz。
會找個時間繼續修正的，雖然目前我也想不到要加啥功能。</p>
<div class="section" id="go">
<h2>Go 的心得</h2>
<p>其實這段才是本文 Orz。
這次寫 Go 我是使用 <a class="reference external" href="http://www.sublimetext.com/2">Sublime Text 2</a> 來作為我的編輯器。
雖然萬能的 Elcipse 也有支援，但是我現在是能不用就不用，他真的太肥了。</p>
<p>Go 的設計讓我覺得他非常的務實，考慮到現在 Coding 的需求。
例如自己就有包涵 gofmt 這個 format 工具，並且可以使用 go install 來安裝 remote respository 的 package。</p>
<p>至少免去了每次要學一個新語言，就必須東找西找各式各樣工具來進行整合。</p>
</div>
<div class="section" id="id1">
<h2>Go 的語法紀錄</h2>
<p>這一次寫得時候還沒有把 Go 的語法看完，所以有很多都是亂用的，並且把 Go 當 C 在寫 Orz。</p>
<div class="section" id="for">
<h3>for 迴圈</h3>
<p>寫習慣了 Scala，看到 for 迴圈就很自然的會去找是否有 for-each 的語法。
在 Go 裡面如果要尋訪 slice 或 map 等容器裡面的每一個元素，使用的是 for + range</p>
<pre class="code go"><a name="rest_code_f189823531cb4a7c89575eec470c655a-1"></a><span class="k">for</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">element</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">slice</span> <span class="p">{</span>
<a name="rest_code_f189823531cb4a7c89575eec470c655a-2"></a>        <span class="o">...</span>
<a name="rest_code_f189823531cb4a7c89575eec470c655a-3"></a><span class="p">}</span>
</pre>
<p>由於 Go 支援多個回傳值，所以 for 後面的 <strong>index</strong> 與 <strong>element</strong> 是會隨著 range 後面所接的對象而改變的。
例如是 map 的話，那麼回傳值就會是 key, value。</p>
</div>
<div class="section" id="id2">
<h3>函式與變數的名稱</h3>
<p>大寫開頭的就是可以在其他 package 被呼叫，小寫得就只能在自己的 package 裡面被呼叫。</p>
</div>
<div class="section" id="id3">
<h3>讀檔與寫檔</h3>
<p>先來段程式碼</p>
<pre class="code go"><a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-1"></a><span class="k">for</span> <span class="p">{</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-2"></a>        <span class="k">if</span> <span class="nx">length</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">reader</span><span class="p">.</span><span class="nx">Read</span><span class="p">(</span><span class="nx">part</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-3"></a>                <span class="k">break</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-4"></a>        <span class="p">}</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-5"></a>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-6"></a>        <span class="k">if</span> <span class="nx">length</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-7"></a>                <span class="nx">f</span><span class="p">.</span><span class="nx">Write</span><span class="p">(</span><span class="nx">part</span><span class="p">[:</span><span class="nx">length</span><span class="p">])</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-8"></a>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-9"></a>                <span class="k">break</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-10"></a>        <span class="p">}</span>
<a name="rest_code_1b881a33cf1f4f818e2b582b0814f004-11"></a><span class="p">}</span>
</pre>
<p>在 C、C++、Java、Scala 等語言基本上在 Write 的 function 中，都會有一個參數是用來帶要寫的長度。
可是 Go 沒有 T_T，所以這段程式碼在剛寫好得時候寫了一堆垃圾資料進去。因為每次都把整個 buffer 寫入。</p>
<p>一直到去 stackoverflow 查詢才發現，原來要善用</p>
<blockquote>
part[:length]</blockquote>
<p>這樣的語法來取出 slice 中特定的某段區域。
更詳細的 slice 內容可以參考 <a class="reference external" href="http://blog.golang.org/2011/01/go-slices-usage-and-internals.html">Go Slices - usage and internals</a></p>
<p>剩下的之後有想到再補上，不過 Go 寫起來也蠻愉快的，我想以後用 Scala 跟 Go 的時間應該會一半一半了。</p>
</div>
</div>
</div>
        </div>
        
        <ul class="pager">
<li class="previous">
                <a href="build-restful-api-server-by-spray.html" rel="prev" title="用 Spray 建立一個簡單的 RESTful API Server">Previous post</a>
            </li>
            <li class="next">
                <a href="goroutine-note-1.html" rel="next" title="Golang - Goroutine 筆記 (1)">Next post</a>
            </li>
        </ul>
<div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="swindgithub",
            disqus_url="http://swind.code-life.info/posts/epubconverter-0_0_2.html",
        disqus_title="EPUBConverter 0.0.2 - \u5176\u5be6\u5df2\u7d93\u91cd\u5beb\u4e86 Orz",
        disqus_identifier="cache/posts/2012-12-08-epubconverter-go.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        

    </div>

        
       <script>var disqus_shortname="swindgithub";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer" role="contentinfo"><p>Contents © 2015 <a href="mailto:">Swind</a> - 
Powered by <a href="http://getnikola.com">Nikola</a> - 
Zen theme based in <a href="https://github.com/arusahni/website-template">Arusahni's website-template</a><br><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a></p>
            
        </footer>
</div>
    </section><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42855873-1', 'code-life.info');
  ga('send', 'pageview');

</script><script src="../assets/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="../assets/js/jquery.timeago.js" type="text/javascript"></script><!-- Social buttons --><div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
 <a class="addthis_button_more"><i class="icon-share-sign icon-2x"></i>    Share</a>
 <ul>
<li>
<a class="addthis_button_twitter"><i class="icon-twitter icon-2x"></i>    Twitter</a>
 </li>
<li>
<a class="addthis_button_google_plusone_share"><i class="icon-google-plus-sign icon-2x"></i>    Google+</a>
 </li>
<li>
<a class="addthis_button_linkedin"><i class="icon-linkedin icon-2x"></i>    Linkedin</a>
 </li>
<li>
<a class="addthis_button_facebook"><i class="icon-facebook-sign icon-2x"></i>    Facebook</a>
 </li>
</ul>
</div>
 <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script><!-- End of social buttons --><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
